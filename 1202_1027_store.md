# 1202_1027_store.md

## src/main/java/com/codehows/taelimbe/store/constant/IndustryType.java
```java
package com.codehows.taelimbe.store.constant;

// ì—…ì¢… íƒ€ì… Enumìœ¼ë¡œ ì´ë¦„ ë³€ê²½ì„ ì œì•ˆí•©ë‹ˆë‹¤.
public enum IndustryType {
    FOOD_BEVERAGE("ì‹ìŒë£Œ"),
    RETAIL("ì†Œë§¤"),
    HOSPITALITY("ì ‘ê°"),
    INDUSTRIAL_FACILITY("ì‚°ì—… ì‹œì„¤/ì°½ê³ /ë¬¼ë¥˜"), // ê¸°ì¡´ ë¬¸ìì—´ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€
    HEALTHCARE("í—¬ìŠ¤ì¼€ì–´"),
    TRANSPORTATION("ìš´ì†¡ ë° ê´€ë ¨ ì„œë¹„ìŠ¤"),
    ENTERTAINMENT_SPORTS("ì—”í„°í…Œì¸ë¨¼íŠ¸ ë° ìŠ¤í¬ì¸ "),
    RESIDENTIAL_OFFICE("ì£¼ê±° ë° ì˜¤í”¼ìŠ¤ ë¹Œë”©"),
    EDUCATION("êµìœ¡"),
    PUBLIC_SERVICE("ê³µê³µ ì„œë¹„ìŠ¤");

    private final String industryName;

    IndustryType(String industryName) {
        this.industryName = industryName;
    }

    public String getIndustryName() {
        return industryName;
    }
}
```

## src/main/java/com/codehows/taelimbe/store/controller/StoreController.java
```java
package com.codehows.taelimbe.store.controller;

import com.codehows.taelimbe.user.dto.UserResponseDTO;
import com.codehows.taelimbe.store.entity.Store;
import com.codehows.taelimbe.user.entity.User;
import com.codehows.taelimbe.store.service.StoreService;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import java.util.List;
import java.util.stream.Collectors;

@Controller
@RequiredArgsConstructor
public class StoreController {

    private final StoreService storeService;

    /**
     * @ResponseBodyë¥¼ ì‚¬ìš©í•˜ë©´ @Controllerì—ì„œë„ JSON ì‘ë‹µì„ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
     * /store?storeId=1 : storeIdê°€ 1ì¸ ë§¤ì¥ë§Œ ì¡°íšŒ
     * /store          : ëª¨ë“  ë§¤ì¥ ì¡°íšŒ
     *
     * @param storeId ì„ íƒì  ë§¤ê°œë³€ìˆ˜ (Long íƒ€ì…, ì—†ì„ ê²½ìš° null)
     * @return ì¡°íšŒëœ Store ì—”í‹°í‹° ëª©ë¡ (JSON)
     */
    @GetMapping("/store")
    @ResponseBody
    public ResponseEntity<List<Store>> checkStore(
            @RequestParam(value = "storeId", required = false) Long storeId) {

        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì„œë¹„ìŠ¤ ê³„ì¸µìœ¼ë¡œ ìœ„ì„í•©ë‹ˆë‹¤.
        List<Store> stores = storeService.findStores(storeId);

        // HTTP 200 OKì™€ í•¨ê»˜ ì¡°íšŒëœ ë§¤ì¥ ëª©ë¡ì„ JSONìœ¼ë¡œ ë°˜í™˜
        return ResponseEntity.ok(stores);
    }

    @GetMapping("/store/user")
    @ResponseBody
    public ResponseEntity<List<UserResponseDTO>> checkUser(
            @RequestParam(value = "storeId", required = false) Long storeId) {

        List<User> users = storeService.findUsers(storeId);

        // ğŸ’¡ User ì—”í‹°í‹° ëª©ë¡ì„ UserResponseDTO ëª©ë¡ìœ¼ë¡œ ë³€í™˜
        List<UserResponseDTO> userDTOs = users.stream()
                .map(UserResponseDTO::fromEntity) // DTOì˜ fromEntity ë©”ì„œë“œ ì‚¬ìš©
                .collect(Collectors.toList());

        // HTTP 200 OKì™€ í•¨ê»˜ DTO ëª©ë¡ì„ JSONìœ¼ë¡œ ë°˜í™˜
        return ResponseEntity.ok(userDTOs);
    }
}
```

## src/main/java/com/codehows/taelimbe/store/entity/Industry.java
```java
package com.codehows.taelimbe.store.entity;

import jakarta.persistence.*;
import lombok.*;

@Entity
@Table(name = "industry")
@NoArgsConstructor
@AllArgsConstructor
@Getter
@Builder
public class Industry {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "industry_id")
    private Long industryId;

    @Column(name = "industry_name", length = 255)
    private String industryName;

}
```

## src/main/java/com/codehows/taelimbe/store/entity/Store.java
```java
package com.codehows.taelimbe.store.entity;

import jakarta.persistence.*;
import lombok.*;

@Entity
@Table(name = "store")
@NoArgsConstructor
@AllArgsConstructor
@Getter
@Setter
@Builder
public class Store {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "store_id")
    private Long storeId;

    @Column(name = "shop_id")
    private Long shopId;

    @Column(name = "shop_name", length = 20)
    private String shopName;

    @ManyToOne
    @JoinColumn(name = "industry_id")
    private Industry industry;

}
```

## src/main/java/com/codehows/taelimbe/store/repository/IndustryRepository.java
```java
package com.codehows.taelimbe.store.repository;

import com.codehows.taelimbe.store.entity.Industry;
import org.springframework.data.jpa.repository.JpaRepository;

public interface IndustryRepository extends JpaRepository<Industry, Long> {


}
```

## src/main/java/com/codehows/taelimbe/store/repository/StoreRepository.java
```java
package com.codehows.taelimbe.store.repository;

import com.codehows.taelimbe.store.entity.Store;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.Optional;

public interface StoreRepository extends JpaRepository<Store, Long> {

    Optional<Store> findByStoreId(Long storeId);

}
```

## src/main/java/com/codehows/taelimbe/store/service/StoreService.java
```java
package com.codehows.taelimbe.store.service;

import com.codehows.taelimbe.store.entity.Store;
import com.codehows.taelimbe.user.entity.User;
import com.codehows.taelimbe.store.repository.StoreRepository;
import com.codehows.taelimbe.user.repository.UserRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.Optional;

@Service // ì´ í´ë˜ìŠ¤ë¥¼ ì„œë¹„ìŠ¤ ë¹ˆìœ¼ë¡œ ë“±ë¡í•©ë‹ˆë‹¤.
@RequiredArgsConstructor
public class StoreService {

    // ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì£¼ì…ë°›ìŠµë‹ˆë‹¤.
    private final StoreRepository storeRepository;
    private final UserRepository userRepository;

    /**
     * storeId ìœ ë¬´ì— ë”°ë¼ ë§¤ì¥ ëª©ë¡ ì „ì²´ ë˜ëŠ” íŠ¹ì • ë§¤ì¥ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
     *
     * @param storeId ì„ íƒì  ë§¤ì¥ ID
     * @return ì¡°íšŒëœ Store ì—”í‹°í‹° ëª©ë¡
     */
    public List<Store> findStores(Long storeId) {
        if (storeId != null) {
            // 1. storeIdê°€ ìˆëŠ” ê²½ìš°: í•´ë‹¹ storeIdë§Œ ì¡°íšŒ
            Optional<Store> storeOptional = storeRepository.findById(storeId);

            // ì¡°íšŒ ê²°ê³¼ê°€ ìˆìœ¼ë©´ í•´ë‹¹ ë§¤ì¥ë§Œ ë¦¬ìŠ¤íŠ¸ì— ë‹´ì•„ ë°˜í™˜í•˜ê³ , ì—†ìœ¼ë©´ ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
            return storeOptional.map(List::of).orElse(List.of());
        } else {
            // 2. storeIdê°€ ì—†ëŠ” ê²½ìš°: ëª¨ë“  ë§¤ì¥ ì¡°íšŒ
            return storeRepository.findAll();
        }
    }

    public List<User> findUsers(Long storeId) {
        if (storeId != null) {
            return userRepository.findByStore_StoreId(storeId);
        } else {
            return userRepository.findAll();
        }
    }
}
```
