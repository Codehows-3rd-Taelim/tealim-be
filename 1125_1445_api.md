---
src/main/java/com/codehows/taelimbe/dto/RobotInfoDTO.java
---
package com.codehows.taelimbe.dto;

import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class RobotInfoDTO {
    private String sn;
    private String mac;
    private String nickname;
    private int online;
    private int battery;
    private int robotStatus;
    private String modelName;
    private String softwareVersion;

}
---
src/main/java/com/codehows/taelimbe/client/PuduAPIClient.java
---
package com.codehows.taelimbe.client;

import lombok.Getter;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Component;

import javax.crypto.Mac;
import javax.crypto.SecretKey;
import javax.crypto.spec.SecretKeySpec;
import java.net.URL;
import java.text.SimpleDateFormat;
import java.util.*;

@Component
public class PuduAPIClient {

    private static final String MAC_NAME = "HmacSHA1";
    private static final String ENCODING = "UTF-8";


    @Value("${api.app.key}")
    private String apiAppKey;

    @Value("${api.app.secret}")
    private String apiAppSecret;

    @Value("${api.host}")
    private String host;

    @Getter
    @Value("${api.base.url}")
    private String baseUrl;

    public ResponseEntity<String> callPuduAPI(String url, String httpMethod) throws Exception {
        String acceptHeader = "application/json";
        String contentType = "";
        String contentMD5 = "";

        // URL parsing
        URL parsedUrl = new URL(url);
        String pathAndParams = parsedUrl.getPath();
        if (parsedUrl.getQuery() != null) {
            pathAndParams += "?" + sortQueryParams(parsedUrl.getQuery());
        }

        String xDate = getGMTTime();
        System.out.println("x-date: " + xDate);

        // ?쒕쾭媛 湲곕??섎뒗 HMAC 臾몄옄??洹몃?濡??ъ슜
        String stringToSign = String.format("x-date: %s\n%s\n%s\n%s\n%s\n%s",
                xDate, httpMethod, acceptHeader, contentType, contentMD5, pathAndParams);

        System.out.println("stringToSign:");
        System.out.println(stringToSign);

        // HMAC ?앹꽦
        byte[] hmacStr = HmacSHA1Encrypt(stringToSign, apiAppSecret);
        String signature = Base64.getEncoder().encodeToString(hmacStr);
        System.out.println("Signature: " + signature);

        // Authorization header ?앹꽦 (怨듬갚 ?쒓굅)
        String authHeader = String.format(
                "hmac id=\"%s\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"%s\"",
                apiAppKey.trim(), signature.trim()
        );
        System.out.println("Authorization: " + authHeader);

        // HTTP ?붿껌
        CloseableHttpClient httpClient = HttpClients.createDefault();
        HttpGet httpGet = new HttpGet(url);
        httpGet.setHeader("Accept", acceptHeader);
        httpGet.setHeader("Host", host);
        httpGet.setHeader("x-date", xDate);
        httpGet.setHeader("Authorization", authHeader);

        CloseableHttpResponse response = httpClient.execute(httpGet);
        int statusCode = response.getStatusLine().getStatusCode();
        String responseBody = EntityUtils.toString(response.getEntity());

        System.out.println("Response Status: " + statusCode);
        System.out.println("Response Body: " + responseBody);
        System.out.println("====== ?꾨즺 ======\n");

        httpClient.close();

        return ResponseEntity.status(statusCode)
                .contentType(MediaType.APPLICATION_JSON)
                .body(responseBody);
    }

    public String getGMTTime() {
        Calendar cd = Calendar.getInstance();
        SimpleDateFormat sdf = new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss 'GMT'", Locale.US);
        sdf.setTimeZone(TimeZone.getTimeZone("GMT"));
        return sdf.format(cd.getTime());
    }

    public String sortQueryParams(String queryParam) {
        if (queryParam == null || queryParam.isEmpty()) return "";

        String[] queryParams = queryParam.split("&");
        Map<String, String> queryPairs = new TreeMap<>();
        for (String query : queryParams) {
            String[] kv = query.split("=", 2);
            String key = kv[0];
            String value = kv.length > 1 ? kv[1] : "";
            queryPairs.put(key, value);
        }

        StringBuilder sb = new StringBuilder();
        for (Map.Entry<String, String> entry : queryPairs.entrySet()) {
            if (sb.length() > 0) sb.append("&");
            sb.append(entry.getKey()).append("=").append(entry.getValue());
        }

        return sb.toString();
    }

    public byte[] HmacSHA1Encrypt(String text, String key) throws Exception {
        SecretKey secretKey = new SecretKeySpec(key.getBytes(ENCODING), MAC_NAME);
        Mac mac = Mac.getInstance(MAC_NAME);
        mac.init(secretKey);
        return mac.doFinal(text.getBytes(ENCODING));
    }
}
---
src/main/java/com/codehows/taelimbe/controller/GeneralShopController.java
---
package com.codehows.taelimbe.controller;

import com.codehows.taelimbe.service.GeneralShopService;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequiredArgsConstructor
@RequestMapping("/api/shop")
public class GeneralShopController {

    private final GeneralShopService generalShopService;

    @GetMapping("/list")
    public ResponseEntity<String> getShopList(
            @RequestParam(defaultValue = "20") int limit,
            @RequestParam(defaultValue = "0") int offset) {
        return generalShopService.getShopList(limit, offset);
    }

    @GetMapping("/robot/list")
    public ResponseEntity<String> getRobotList(
            @RequestParam(defaultValue = "20") int limit,
            @RequestParam(defaultValue = "0") int offset,
            @RequestParam(required = false) Long shop_id,
            @RequestParam(required = false) String[] product_code) {
        return generalShopService.getRobotList(limit, offset, shop_id, product_code);
    }
}
---
src/main/java/com/codehows/taelimbe/controller/ReportController.java
---
package com.codehows.taelimbe.controller;

import com.codehows.taelimbe.service.ReportService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;


// ?놁뼱吏?
@RestController
@RequestMapping("/api/robot")
public class ReportController {

    @Autowired
    private ReportService reportService;

    @GetMapping("/test")
    public ResponseEntity<String> test() {
        return ResponseEntity.ok("Server running. Cleaning Report API Ready.");
    }

    @GetMapping("/report/list")
    public ResponseEntity<String> getCleanReportList(
            @RequestParam long start_time,
            @RequestParam long end_time,
            @RequestParam(defaultValue = "0") int offset,
            @RequestParam(defaultValue = "20") int limit,
            @RequestParam(defaultValue = "0") int timezone_offset,
            @RequestParam Long shop_id) {
        return reportService.getCleanReportList(start_time, end_time, offset, limit, timezone_offset, shop_id);
    }

    @GetMapping("/report/detail")
    public ResponseEntity<String> getCleanReportDetail(
            @RequestParam String sn,
            @RequestParam String report_id,
            @RequestParam long start_time,
            @RequestParam long end_time,
            @RequestParam(defaultValue = "0") int timezone_offset,
            @RequestParam(required = false) Long shop_id) {
        return reportService.getCleanReportDetail(sn, report_id, start_time, end_time, timezone_offset, shop_id);
    }
}
---
src/main/java/com/codehows/taelimbe/controller/RobotRobotController.java
---
package com.codehows.taelimbe.controller;

import com.codehows.taelimbe.service.RobotRobotService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api/robot")
public class RobotRobotController {

    @Autowired
    private RobotRobotService robotRobotService;

    @GetMapping("/detail")
    public ResponseEntity<String> getRobotDetail(@RequestParam String sn) {
        return robotRobotService.getRobotDetail(sn);
    }

    @GetMapping("/full-info")
    public ResponseEntity<?> getRobotFullInfo(
            @RequestParam String sn,
            @RequestParam long shop_id,
            @RequestParam(required = false) Long start_time,
            @RequestParam(required = false) Long end_time,
            @RequestParam(defaultValue = "0") int timezone_offset,
            @RequestParam(defaultValue = "20") int limit) {

        // Service??6媛??뚮씪誘명꽣 紐⑤몢 ?꾨떖
        // null 媛믪? Service?먯꽌 泥섎━ (湲곕낯媛??ㅼ젙)
        return robotRobotService.getRobotFullInfo(sn, shop_id, start_time, end_time, timezone_offset, limit);
    }
}
---
src/main/java/com/codehows/taelimbe/controller/StatisticalLogController.java
---
package com.codehows.taelimbe.controller;

import com.codehows.taelimbe.service.StatisticalLogService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api/robot")
public class StatisticalLogController {

    @Autowired
    private StatisticalLogService statisticalLogService;

    @GetMapping("/charging/list")
    public ResponseEntity<String> getChargingRecordList(
            @RequestParam long start_time,
            @RequestParam long end_time,
            @RequestParam(defaultValue = "0") int offset,
            @RequestParam(defaultValue = "20") int limit,
            @RequestParam(defaultValue = "0") int timezone_offset,
            @RequestParam(required = false) Long shop_id) {
        return statisticalLogService.getChargingRecordList(start_time, end_time, offset, limit, timezone_offset, shop_id);
    }

    // =============================
    // ?뵅 Battery Health Status
    // =============================
    @GetMapping("/battery/list")
    public ResponseEntity<String> getBatteryHealthList(
            @RequestParam long start_time,
            @RequestParam long end_time,
            @RequestParam(defaultValue = "0") int offset,
            @RequestParam(defaultValue = "20") int limit,
            @RequestParam(defaultValue = "0") int timezone_offset,
            @RequestParam(required = false) Long shop_id,
            @RequestParam(required = false) String sn,
            @RequestParam(required = false) Integer min_cycle,
            @RequestParam(required = false) Integer max_cycle,
            @RequestParam(required = false) Integer min_full_capacity,
            @RequestParam(required = false) Integer max_full_capacity
    ) {
        return statisticalLogService.getBatteryHealthList(
                start_time, end_time, offset, limit, timezone_offset,
                shop_id, sn,
                min_cycle, max_cycle,
                min_full_capacity, max_full_capacity
        );
    }

    // =============================
    // ?윦 Power-on Self-test (遺???먭?吏꾨떒)
    // =============================
    @GetMapping("/boot/list")
    public ResponseEntity<String> getBootLogList(
            @RequestParam long start_time,
            @RequestParam long end_time,
            @RequestParam(defaultValue = "0") int offset,
            @RequestParam(defaultValue = "20") int limit,
            @RequestParam(defaultValue = "0") int timezone_offset,
            @RequestParam(required = false) Long shop_id,
            @RequestParam(required = false) String check_step,
            @RequestParam(required = false) Integer is_success) {

        return statisticalLogService.getBootLogList(
                start_time, end_time, offset, limit, timezone_offset,
                shop_id, check_step, is_success
        );
    }

}
---
src/main/java/com/codehows/taelimbe/service/GeneralShopService.java
---
package com.codehows.taelimbe.service;

import com.codehows.taelimbe.client.PuduAPIClient;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.util.UriComponentsBuilder;

@RequiredArgsConstructor
@Service
public class GeneralShopService {

    private final PuduAPIClient puduAPIClient;

    public ResponseEntity<String> getShopList(int limit, int offset) {
        try {
            System.out.println("====== 留ㅼ옣 紐⑸줉 議고쉶 ?쒖옉 ======");
            System.out.println("Limit: " + limit);
            System.out.println("Offset: " + offset);

            String url = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-open-platform-service/v1/api/shop")
                    .queryParam("limit", limit)
                    .queryParam("offset", offset)
                    .toUriString();

            System.out.println("Target URL: " + url);
            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }

    public ResponseEntity<String> getRobotList(int limit, int offset, Long shop_id, String[] product_code) {
        try {
            System.out.println("====== 濡쒕큸 紐⑸줉 議고쉶 ?쒖옉 ======");
            System.out.println("Limit: " + limit);
            System.out.println("Offset: " + offset);

            UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-open-platform-service/v1/api/robot")
                    .queryParam("limit", limit)
                    .queryParam("offset", offset);

            if (shop_id != null) {
                builder.queryParam("shop_id", shop_id);
            }

            if (product_code != null && product_code.length > 0) {
                for (String code : product_code) {
                    builder.queryParam("product_code", code);
                }
            }

            String url = builder.toUriString();
            System.out.println("Target URL: " + url);
            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }
}

---
src/main/java/com/codehows/taelimbe/service/ReportService.java
---
package com.codehows.taelimbe.service;

import com.codehows.taelimbe.client.PuduAPIClient;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.util.UriComponentsBuilder;

import java.util.Optional;

@Service
public class ReportService {

    private final PuduAPIClient puduAPIClient;

    public ReportService(PuduAPIClient puduAPIClient) {
        this.puduAPIClient = puduAPIClient;
    }

    public ResponseEntity<String> getCleanReportList(long start_time, long end_time,
                                                     int offset, int limit, int timezone_offset,
                                                     Long shop_id) {
        try {
            System.out.println("====== Cleaning Report 紐⑸줉 議고쉶 ?쒖옉 ======");

            String url = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-board/v1/log/clean_task/query_list")
                    .queryParam("start_time", start_time)
                    .queryParam("end_time", end_time)
                    .queryParam("offset", offset)
                    .queryParam("limit", limit)
                    .queryParam("timezone_offset", timezone_offset)
                    .queryParam("shop_id", shop_id)
                    .toUriString();

            System.out.println("Target URL: " + url);
            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }

    public ResponseEntity<String> getCleanReportDetail(String sn, String report_id,
                                                       long start_time, long end_time,
                                                       int timezone_offset, Long shop_id) {
        try {
            System.out.println("====== Cleaning Report ?곸꽭 議고쉶 ?쒖옉 ======");

            UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-board/v1/log/clean_task/query")
                    .queryParam("sn", sn)
                    .queryParam("report_id", report_id)
                    .queryParam("start_time", start_time)
                    .queryParam("end_time", end_time)
                    .queryParam("timezone_offset", timezone_offset);

            if (shop_id != null) {
                builder.queryParam("shop_id", shop_id);
            }

            String url = builder.toUriString();
            System.out.println("Target Detail URL: " + url);
            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }
}
---
src/main/java/com/codehows/taelimbe/service/RobotRobotService.java
---
package com.codehows.taelimbe.service;

import com.codehows.taelimbe.client.PuduAPIClient;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.node.ObjectNode;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.util.UriComponentsBuilder;

import java.net.URLEncoder;

@Service
public class RobotRobotService {

    private final PuduAPIClient puduAPIClient;
    private final ObjectMapper objectMapper;
    private static final String ENCODING = "UTF-8";

    public RobotRobotService(PuduAPIClient puduAPIClient, ObjectMapper objectMapper) {
        this.puduAPIClient = puduAPIClient;
        this.objectMapper = objectMapper;
    }

    public ResponseEntity<String> getRobotDetail(String sn) {
        try {
            System.out.println("====== 濡쒕큸 ?곸꽭 議고쉶 ?쒖옉 ======");
            System.out.println("SN: " + sn);

            String url = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/cleanbot-service/v1/api/open/robot/detail")
                    .queryParam("sn", sn)
                    .toUriString();

            System.out.println("Target URL: " + url);
            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }

    public ResponseEntity<?> getRobotFullInfo(String sn, long shop_id, Long start_time, Long end_time,
                                              int timezone_offset, int limit) {
        try {
            System.out.println("====== 濡쒕큸 ?꾩껜 ?뺣낫 議고쉶 ?쒖옉 ======");
            System.out.println("SN: " + sn);
            System.out.println("Shop ID: " + shop_id);
            System.out.println("Start Time: " + start_time);
            System.out.println("End Time: " + end_time);
            System.out.println("Timezone Offset: " + timezone_offset);
            System.out.println("Limit: " + limit);

            // 1. 濡쒕큸 ?곸꽭 ?뺣낫 議고쉶
            ResponseEntity<String> robotResponse = getRobotDetail(sn);
            String robotJson = robotResponse.getBody();

            // 2. 異⑹쟾 ?뺣낫 議고쉶
            // start_time, end_time??null?대㈃ 湲곕낯媛믪쑝濡?24?쒓컙 ???ㅼ젙
            long st = (start_time != null) ? start_time : System.currentTimeMillis() / 1000 - 86400;
            long et = (end_time != null) ? end_time : System.currentTimeMillis() / 1000;

            String chargingUrl = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-board/v1/log/charge/query_list")
                    .queryParam("start_time", st)
                    .queryParam("end_time", et)
                    .queryParam("offset", 0)
                    .queryParam("limit", limit)
                    .queryParam("timezone_offset", timezone_offset)
                    .queryParam("shop_id", shop_id)
                    .toUriString();

            System.out.println("Charging URL: " + chargingUrl);
            ResponseEntity<String> chargingResponse = puduAPIClient.callPuduAPI(chargingUrl, "GET");
            String chargingJson = chargingResponse.getBody();

            // 3. ?곗씠??寃고빀
            ObjectNode combinedData = combineRobotData(robotJson, chargingJson);

            return ResponseEntity.ok(combinedData);

        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }

    /**
     * 濡쒕큸 ?뺣낫? 異⑹쟾 ?뺣낫瑜?寃고빀
     *
     * 異뷀썑 ?ㅻⅨ ?쒕퉬?ㅼ뿉?쒕룄 媛숈? 濡쒖쭅???꾩슂?섎㈃
     * DataCombiningService濡?遺꾨━ ?덉젙
     */
    private ObjectNode combineRobotData(String robotJson, String chargingJson) throws Exception {
        JsonNode robotNode = objectMapper.readTree(robotJson);
        JsonNode chargingNode = objectMapper.readTree(chargingJson);

        ObjectNode result = objectMapper.createObjectNode();

        // 濡쒕큸 ?뺣낫 異붿텧
        if (robotNode.has("data")) {
            JsonNode data = robotNode.get("data");
            result.put("sn", data.get("sn").asText());
            result.put("mac", data.get("mac").asText());
            result.put("nickname", data.get("nickname").asText());
            result.put("online", data.get("online").asInt());
            result.put("battery", data.get("battery").asInt());
            result.put("robotStatus", data.get("status").asInt());
        }

        // 異⑹쟾 ?뺣낫 異붿텧
        if (chargingNode.has("data")) {
            JsonNode data = chargingNode.get("data");
            if (data.isArray() && data.size() > 0) {
                JsonNode firstRecord = data.get(0);
                result.put("modelName", firstRecord.get("model_name").asText());
                result.put("softwareVersion", firstRecord.get("software_version").asText());
            }
        }

        return result;
    }
}
---
src/main/java/com/codehows/taelimbe/service/StatisticalLogService.java
---
package com.codehows.taelimbe.service;

import com.codehows.taelimbe.client.PuduAPIClient;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.util.UriComponentsBuilder;

@RequiredArgsConstructor
@Service
public class StatisticalLogService {

    private final PuduAPIClient puduAPIClient;


    //理쒖떊?쒖쑝濡??섏삩??
    public ResponseEntity<String> getChargingRecordList(long start_time, long end_time,
                                                        int offset, int limit, int timezone_offset,
                                                        Long shop_id) {
        try {
            System.out.println("====== Charging Record 紐⑸줉 議고쉶 ?쒖옉 ======");
            System.out.println("Start Time: " + start_time);
            System.out.println("End Time: " + end_time);
            System.out.println("Offset: " + offset);
            System.out.println("Limit: " + limit);

            UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-board/v1/log/charge/query_list")
                    .queryParam("start_time", start_time)
                    .queryParam("end_time", end_time)
                    .queryParam("offset", offset)
                    .queryParam("limit", limit)
                    .queryParam("timezone_offset", timezone_offset);

            if (shop_id != null) {
                builder.queryParam("shop_id", shop_id);
            }

            String url = builder.toUriString();
            System.out.println("Target URL: " + url);
            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }


    //?닿굅 議곌툑 ?댁긽?? ?곗?留덉뀍
    public ResponseEntity<String> getBatteryHealthList(long start_time, long end_time,
                                                       int offset, int limit, int timezone_offset,
                                                       Long shop_id, String sn,
                                                       Integer min_cycle, Integer max_cycle,
                                                       Integer min_full_capacity, Integer max_full_capacity) {
        try {
            System.out.println("====== Battery Health 紐⑸줉 議고쉶 ?쒖옉 ======");
            System.out.println("Start Time: " + start_time);
            System.out.println("End Time: " + end_time);
            System.out.println("Offset: " + offset);
            System.out.println("Limit: " + limit);

            UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-board/v1/log/battery/query_list")
                    .queryParam("start_time", start_time)
                    .queryParam("end_time", end_time)
                    .queryParam("offset", offset)
                    .queryParam("limit", limit)
                    .queryParam("timezone_offset", timezone_offset);

            // ?좏깮 ?뚮씪誘명꽣??
            if (shop_id != null) builder.queryParam("shop_id", shop_id);
            if (sn != null && !sn.isEmpty()) builder.queryParam("sn", sn);
            if (min_cycle != null) builder.queryParam("min_cycle", min_cycle);
            if (max_cycle != null) builder.queryParam("max_cycle", max_cycle);
            if (min_full_capacity != null) builder.queryParam("min_full_capacity", min_full_capacity);
            if (max_full_capacity != null) builder.queryParam("max_full_capacity", max_full_capacity);

            String url = builder.toUriString();

            System.out.println("Battery Health Target URL: " + url);

            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();

            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }

    // ================================================
    // ?윦 Power-on Self-test (遺???먭?吏꾨떒 濡쒓렇)
    // ================================================
    public ResponseEntity<String> getBootLogList(long start_time,
                                                 long end_time,
                                                 int offset,
                                                 int limit,
                                                 int timezone_offset,
                                                 Long shop_id,
                                                 String check_step,
                                                 Integer is_success) {

        try {
            System.out.println("====== Boot Log 紐⑸줉 議고쉶 ?쒖옉 ======");
            System.out.println("Start Time: " + start_time);
            System.out.println("End Time: " + end_time);
            System.out.println("Offset: " + offset);
            System.out.println("Limit: " + limit);

            UriComponentsBuilder builder = UriComponentsBuilder
                    .fromHttpUrl(puduAPIClient.getBaseUrl())
                    .path("/data-board/v1/log/boot/query_list")
                    .queryParam("start_time", start_time)
                    .queryParam("end_time", end_time)
                    .queryParam("offset", offset)
                    .queryParam("limit", limit)
                    .queryParam("timezone_offset", timezone_offset);

            // ===== ?듭뀡 ?뚮씪誘명꽣 =====
            if (shop_id != null) {
                builder.queryParam("shop_id", shop_id);
            }

            if (check_step != null && !check_step.isEmpty()) {
                builder.queryParam("check_step", check_step);
            }

            if (is_success != null) {
                builder.queryParam("is_success", is_success);
            }

            // 理쒖쥌 URL
            String url = builder.toUriString();
            System.out.println("Boot Log Target URL: " + url);

            return puduAPIClient.callPuduAPI(url, "GET");

        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();

            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("{\"error\": \"" + e.getMessage() + "\"}");
        }
    }

}
---
src/main/java/com/codehows/taelimbe/service/detail/DataCombiningService.java
---
package com.codehows.taelimbe.service.detail;

import com.codehows.taelimbe.dto.RobotInfoDTO;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.stereotype.Service;

@Service
public class DataCombiningService {

    private final ObjectMapper objectMapper;

    public DataCombiningService(ObjectMapper objectMapper) {
        this.objectMapper = objectMapper;
    }

    public RobotInfoDTO combineRobotData(String robotJson, String chargingJson) throws Exception {
        JsonNode robotNode = objectMapper.readTree(robotJson);
        JsonNode chargingNode = objectMapper.readTree(chargingJson);

        RobotInfoDTO robotInfo = new RobotInfoDTO();

        // robotJson?먯꽌 異붿텧
        if (robotNode.has("data")) {
            JsonNode data = robotNode.get("data");
            robotInfo.setSn(data.get("sn").asText());
            robotInfo.setMac(data.get("mac").asText());
            robotInfo.setNickname(data.get("nickname").asText());
            robotInfo.setOnline(data.get("online").asInt());
            robotInfo.setBattery(data.get("battery").asInt());
            robotInfo.setRobotStatus(data.get("status").asInt());
        }

        // chargingJson?먯꽌 異붿텧
        if (chargingNode.has("data")) {
            JsonNode data = chargingNode.get("data");
            if (data.isArray() && data.size() > 0) {
                JsonNode firstRecord = data.get(0);
                robotInfo.setModelName(firstRecord.get("model_name").asText());
                robotInfo.setSoftwareVersion(firstRecord.get("software_version").asText());
            }
        }

        return robotInfo;
    }
}
---
src/main/java/com/codehows/taelimbe/service/detail/DataProcessingService.java
---
package com.codehows.taelimbe.service.detail;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.stereotype.Service;

@Service
public class DataProcessingService {

    private final ObjectMapper objectMapper;

    public DataProcessingService(ObjectMapper objectMapper) {
        this.objectMapper = objectMapper;
    }

    public <T> T parseJson(String json, Class<T> clazz) throws Exception {
        return objectMapper.readValue(json, clazz);
    }

    public String toJsonString(Object object) throws Exception {
        return objectMapper.writeValueAsString(object);
    }

    // ?꾩슂??異붽? 泥섎━ 濡쒖쭅?ㅼ쓣 ?ш린??異붽?
}


